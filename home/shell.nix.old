
{ pkgs, ... }: {

  programs.zsh = {
    enable = true;
    # enableCompletion = true;
    # autosuggestion.enable = true;
    # syntaxHighlighting.enable = true;
    # oh-my-zsh = {
    #   enable = true;
    #   custom = "/Users/quinn/.oh-my-zsh";
    #   plugins = [ "eza" "zsh-navigation-tools" ];
    # };
    # shellAliases = {
    #   py = "python";
    #   nix-shell = "nix-shell --run zsh";
    #   nix-clean = "sudo nix-collect-garbage && sudo nix-collect-garbage -d && sudo rm /nix/var/nix/gcroots/auto/* && nix-collect-garbage && nix-collect-garbage -d";
    # };
    initExtra = ''
    export PATH=''$HOME/bin:/usr/local/bin:''$HOME/.local/bin:''$PATH
    
    # Path to your oh-my-zsh installation.
    export ZSH=''$HOME/.oh-my-zsh
    
    export DARWIN_CONFIG_DIR=''$HOME/.config/darwin
    
    zstyle ':omz:update' mode auto      # update automatically without asking
    zstyle ':omz:update' frequency 13
    
    # Uncomment the following line if pasting URLs and other text is messed up.
    # DISABLE_MAGIC_FUNCTIONS="true"
    
    DISABLE_UNTRACKED_FILES_DIRTY="true"

    HIST_STAMPS="mm/dd/yyyy"
    
    # Plugins
    plugins=(colorize zsh-navigation-tools iterm2 zsh-syntax-highlighting zsh-autosuggestions)
    
    # Source OMZ script.
    source ''$ZSH/oh-my-zsh.sh
    
    export LANG=en_US.UTF-8
    
    if [[ -n ''$SSH_CONNECTION ]]; then
      export EDITOR="nano"
    else
      export EDITOR="micro"
    fi

    export ZSCRIPTS=''$HOME/.oh-my-zsh/custom/scripts

    export HOMEBREW_PREFIX="/opt/homebrew"
    export HOMEBREW_CELLAR="/opt/homebrew/Cellar"
    export PATH="/opt/homebrew/bin:/opt/homebrew/sbin:''${PATH+:''$PATH}"
    export HOMEBREW_REPOSITORY="/opt/homebrew"
    export MANPATH="/opt/homebrew/share/man''${MANPATH+:''$MANPATH}:"
    export INFOPATH="/opt/homebrew/share/info:''${INFOPATH:-}"

    export PATH="/Library/Frameworks/Python.framework/Versions/3.12/bin:''${PATH}"

    export PATH="/run/current-system/sw/bin:''${PATH+:''$PATH}"
    
    ## Source extra customs.
    for f (~/.oh-my-zsh/custom/scripts/*(N.)) . ''$f

    export MICRO_TRUECOLOR=1

    test -e /Users/quinn/.iterm2_shell_integration.zsh && source /Users/quinn/.iterm2_shell_integration.zsh || true

    export STARSHIP_CONFIG=~/.config/starship.toml
    eval "''$(starship init zsh)"
    '';
  };
}
